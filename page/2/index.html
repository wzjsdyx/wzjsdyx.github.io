<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/animal_toy_cute_doll_teddy_72.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/animal_toy_cute_doll_teddy_72.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"wzjsdyx.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="show me bug">
<meta property="og:type" content="website">
<meta property="og:title" content="芯青年">
<meta property="og:url" content="https://wzjsdyx.github.io/page/2/index.html">
<meta property="og:site_name" content="芯青年">
<meta property="og:description" content="show me bug">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Youngster">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://wzjsdyx.github.io/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>芯青年</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">芯青年</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wzjsdyx.github.io/2024/08/07/eflash-controller-software-command/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/animal_toy_cute_doll_teddy_256.png">
      <meta itemprop="name" content="Youngster">
      <meta itemprop="description" content="show me bug">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="芯青年">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/08/07/eflash-controller-software-command/" class="post-title-link" itemprop="url">eflash controller software command</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-08-07 09:47:09" itemprop="dateCreated datePublished" datetime="2024-08-07T09:47:09+08:00">2024-08-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-08-14 16:46:38" itemprop="dateModified" datetime="2024-08-14T16:46:38+08:00">2024-08-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/eflash/" itemprop="url" rel="index"><span itemprop="name">eflash</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/eflash/tsmc-auot-eflash-controller/" itemprop="url" rel="index"><span itemprop="name">tsmc auot eflash controller</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/08/07/eflash-controller-software-command/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/08/07/eflash-controller-software-command/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="page-erase"><a href="#page-erase" class="headerlink" title="page erase"></a>page erase</h1><p>1、page erase操作会调用SMWR IP，SME操作会遵循SME操作流程图；</p>
<blockquote>
<ol>
<li><p><strong>开始擦除 (Start Erase)</strong>:</p>
<ul>
<li>流程开始，初始化擦除操作。</li>
</ul>
</li>
<li><p><strong>初始化计数器</strong>:</p>
<ul>
<li>擦除脉冲计数器 NNN 被设为 0。</li>
<li>后擦除计数器 MMM 被设为 0。</li>
</ul>
</li>
<li><p><strong>设置擦除电压</strong>:</p>
<ul>
<li>擦除电压设置为高电平 (EV&#x3D;H)。</li>
<li>设置写入电压寄存器 (WHV3:03:03:0)。</li>
</ul>
</li>
<li><p><strong>执行擦除 (Do Erase)</strong>:</p>
</li>
</ol>
<ul>
<li>进行实际的擦除操作。</li>
</ul>
<ol start="5">
<li><strong>执行后擦除读取 (Do Post-Erase Read)</strong>:</li>
</ol>
<ul>
<li><font color=blue>初步读取和检查步骤，用于获得擦除后的数据状态，并为后续的擦除验证提供基础数据。</font></li>
</ul>
<ol start="6">
<li><strong>增加擦除脉冲计数器</strong>:</li>
</ol>
<ul>
<li>擦除脉冲计数器 N 增加 1。</li>
</ul>
<ol start="7">
<li><strong>擦除验证 (Erase Verify)</strong>:</li>
</ol>
<ul>
<li>验证擦除是否成功。</li>
</ul>
<ol start="8">
<li><strong>验证成功</strong>:</li>
</ol>
<ul>
<li><p><font color=blue>即使擦除验证通过，为了确保擦除的彻底性，可能还需要进行额外擦除操作。这可能是为了应对一些边缘情况，确保数据完全擦除。&#x3D;&#x3D;&gt;大概率和Macro的自身设计有关，Erase Verify并不能cover到所有的情况，因此需要足够的额外擦除操作（M &gt;&#x3D; POST_ERS ），以保证数据完全擦除。</font></p>
</li>
<li><p>如果 M 大于等于 POST_ERS，流程结束。</p>
</li>
<li><p>如果 M 小于 POST_ERS，执行额外擦除操作，后擦除计数器 MMM 增加 1，然后返回步骤 4 继续擦除。</p>
</li>
</ul>
<ol start="9">
<li><strong>失败处理</strong>:</li>
</ol>
<ul>
<li>如果擦除失败，检查擦除脉冲计数器 N 是否大于 N_me。<ul>
<li>如果 N 大于 N_me，擦除操作失败，流程结束。</li>
<li>如果 N 小于 N_me，返回步骤 4 继续擦除。</li>
</ul>
</li>
</ul>
<p>术语解释</p>
<ul>
<li><strong>N_me</strong>: 最大擦除脉冲次数，通常是基于特定芯片的耐久性限制。</li>
<li><strong>T_erase</strong>: 总擦除时间。</li>
<li><strong>T_sme</strong>: 智能擦除操作的时间。</li>
</ul>
</blockquote>
<p>2、SWMR的工作状态可以通过端口信号判断；</p>
<blockquote>
<p>1、User assert <code>SMW_OP</code></p>
<ul>
<li>SME2：3’b010, one-shot mass-erase on MAIN array or MAIN, IFREN, and REDEN arrays, Tme is fixed based on macro specs</li>
<li>SME3：3’b011, smart-page-erase on selected array</li>
</ul>
<p>2、TSMWR asserts </p>
<ul>
<li><code>SMWR_BUSY</code> signal high until smart-erase cycle is completed.   </li>
<li><code>SMWR_ERR</code> indicates PASS(0) or FAIL(1) of the cycle, </li>
<li><code>SMWR_LASTSET</code>, and <code>SMWR_LOOP</code> indicate detailed internal setting to complete the “smart-write” cycle.</li>
</ul>
</blockquote>
<blockquote>
<p>Q&amp;A：</p>
<p>Q1、page erase operation，到底是什么信号触发了是让SMWR动起来？SMWR动起来之后，会拉高swm_busy信号，使得smw_mux输出的是smw_top的信号而不是user信号；</p>
<p>A1：通过SME操作时序图，可以判断是因为前一级触发了smw_op，然后让SMWR动起来；</p>
<p>Q2、SME操作流程图怎么理解？</p>
<p>A2：如上解释</p>
</blockquote>
<h1 id="mass-erase命令"><a href="#mass-erase命令" class="headerlink" title="mass erase命令"></a>mass erase命令</h1><p>pflash main区域和dflash main区域是分开操作的，需要不同的指令</p>
<p>操作的地址只要是在对应的main区域中，即可？？？</p>
<p>&#x2F;&#x2F; try遇到的问题</p>
<p>eflash boot，debugger不能erase flash main区域？</p>
<p>1、先确认读写保护寄存器；</p>
<p>2、根据读写保护规则确定行为；</p>
<h2 id="Macro-mass-erase的操作范围："><a href="#Macro-mass-erase的操作范围：" class="headerlink" title="Macro mass erase的操作范围："></a>Macro mass erase的操作范围：</h2><h1 id="reference-cell-erase"><a href="#reference-cell-erase" class="headerlink" title="reference cell erase"></a>reference cell erase</h1><p>空片必须要执行一次reference cell erase；</p>
<h2 id="软件流程"><a href="#软件流程" class="headerlink" title="软件流程"></a>软件流程</h2><p>首先写FMUKR 0x00ac7805 -&gt;  0x01234567 unlock；</p>
<p>然后针对FMSPCLCK写32’h3322 1100 -&gt; 32’hffee ddcc；</p>
<p>最后写FMCCR寄存器，执行reference erase 命令；</p>
<h2 id="硬件流程"><a href="#硬件流程" class="headerlink" title="硬件流程"></a>硬件流程</h2><p>仿真流程</p>
<p>1、user logic控制pflash Macro执行reference cell erase</p>
<p>2、user logic控制dflash Macro执行reference cell erase</p>
<p>3、user logic控制pflash Macro执行mass erase&#x3D;&#x3D;》pflash main array</p>
<p>4、smart-write IP采用SM3对pflash Macro区域执行page erase&#x3D;&#x3D;》pflash info page0和page1</p>
<p>5、user logic控制dflash Macro执行mass erase&#x3D;&#x3D;》dflash main array</p>
<p>实际芯片的流程</p>
<p>时序图</p>
<p>遇到的问题</p>
<img src="/2024/08/07/eflash-controller-software-command/image-20240809141508322.png" class="">

<p>解决思路</p>
<ul>
<li>reference cell erase执行完之后，怎么判断有没有执行成功</li>
</ul>
<p>没办法判断，只能按照时序图来，最好多添加一些余量；</p>
<ul>
<li>对pflash info区域进行erase操作（利用smart ip）：</li>
</ul>
<p>1、smart-ip flow怎么和波形对应？&#x3D;&#x3D;》这个其实可以不用管，只要给command到smwr IP，其能够正确执行page erase操作即可；</p>
<p>2、怎么看是对应哪一个page进行操作？&#x3D;&#x3D;》通过地址解码table</p>
<ul>
<li>reference cell erase命令，执行的范围怎么定？</li>
</ul>
<h1 id="page-program"><a href="#page-program" class="headerlink" title="page program"></a>page program</h1><h2 id="software-page-program的使用方式"><a href="#software-page-program的使用方式" class="headerlink" title="software page program的使用方式"></a>software page program的使用方式</h2><img src="/2024/08/07/eflash-controller-software-command/image-20240809103335826.png" class="">

<blockquote>
<p>NOTE：</p>
<p>1、硬件首先会verify判断当前地址是否有valid data</p>
<p>2、如果有valid data的话，需要先erase；</p>
</blockquote>
<h2 id="硬件执行机制"><a href="#硬件执行机制" class="headerlink" title="硬件执行机制"></a>硬件执行机制</h2><h3 id="SMP-flow-chart"><a href="#SMP-flow-chart" class="headerlink" title="SMP flow chart"></a>SMP flow chart</h3><img src="/2024/08/07/eflash-controller-software-command/image-20240814134414239.png" class="">



<blockquote>
<p>Note: Once “prog_mask” is set to’1’ for existing ‘0’ bit, it will keep at ‘1’ till end of SMP by<br>default.</p>
</blockquote>
<h3 id="Smart-Program-Operation"><a href="#Smart-Program-Operation" class="headerlink" title="Smart-Program Operation"></a>Smart-Program Operation</h3><img src="/2024/08/07/eflash-controller-software-command/image-20240814135309547.png" class="">



<blockquote>
<p>NOTE：</p>
<p>SMW_OP</p>
<p>SWM_BUSY</p>
<p>SMW_ERR</p>
<p>SMW_LATESET</p>
<p>SMW_LOOP</p>
<p>思考：</p>
<p><font color=red>SMWR burst-write??</font></p>
</blockquote>
<h2 id="时序图"><a href="#时序图" class="headerlink" title="时序图"></a>时序图</h2><h1 id="option-page-program"><a href="#option-page-program" class="headerlink" title="option page program"></a>option page program</h1><h2 id="software-option-page-program的使用方式"><a href="#software-option-page-program的使用方式" class="headerlink" title="software option page program的使用方式"></a>software option page program的使用方式</h2><p><img src="D:\blog\wzjsdyx.github.io\source_posts\2024-08-07-eflash-controller-software-command\image-20240814152102767.png" alt="image-20240814152102767"></p>
<p><img src="D:\blog\wzjsdyx.github.io\source_posts\2024-08-07-eflash-controller-software-command\image-20240814152118901.png" alt="image-20240814152118901"></p>
<blockquote>
<p>NOTE：</p>
<p>1、当SEGWREN是enable的时候，pflash info page2 和option page的属性相同；</p>
<p>2、当做read protect&#x3D;&#x3D;》non read protect，此SW命令会对pflash main 和 dflash main做mass erase；</p>
<p>3、program之后，SMWR IP会做program verify操作；</p>
</blockquote>
<h2 id="硬件执行机制-1"><a href="#硬件执行机制-1" class="headerlink" title="硬件执行机制"></a>硬件执行机制</h2><h1 id="page-verify"><a href="#page-verify" class="headerlink" title="page verify"></a>page verify</h1>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wzjsdyx.github.io/2024/08/06/Cortex-M4%E7%9A%84%E6%97%B6%E9%92%9F-%E5%A4%8D%E4%BD%8D-Power-control/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/animal_toy_cute_doll_teddy_256.png">
      <meta itemprop="name" content="Youngster">
      <meta itemprop="description" content="show me bug">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="芯青年">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/08/06/Cortex-M4%E7%9A%84%E6%97%B6%E9%92%9F-%E5%A4%8D%E4%BD%8D-Power-control/" class="post-title-link" itemprop="url">Cortex-M4的时钟/复位/Power control</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-08-06 15:45:26 / 修改时间：15:52:55" itemprop="dateCreated datePublished" datetime="2024-08-06T15:45:26+08:00">2024-08-06</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Cortex-M4/" itemprop="url" rel="index"><span itemprop="name">Cortex-M4</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/08/06/Cortex-M4%E7%9A%84%E6%97%B6%E9%92%9F-%E5%A4%8D%E4%BD%8D-Power-control/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/08/06/Cortex-M4%E7%9A%84%E6%97%B6%E9%92%9F-%E5%A4%8D%E4%BD%8D-Power-control/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="demo时钟结构"><a href="#demo时钟结构" class="headerlink" title="demo时钟结构"></a>demo时钟结构</h1><img src="/2024/08/06/Cortex-M4%E7%9A%84%E6%97%B6%E9%92%9F-%E5%A4%8D%E4%BD%8D-Power-control/image-20240806155104547.png" class="">



<h1 id="demo复位结构"><a href="#demo复位结构" class="headerlink" title="demo复位结构"></a>demo复位结构</h1><img src="/2024/08/06/Cortex-M4%E7%9A%84%E6%97%B6%E9%92%9F-%E5%A4%8D%E4%BD%8D-Power-control/image-20240806154906930.png" class="">



<h1 id="demo-power-control"><a href="#demo-power-control" class="headerlink" title="demo power control"></a>demo power control</h1><img src="/2024/08/06/Cortex-M4%E7%9A%84%E6%97%B6%E9%92%9F-%E5%A4%8D%E4%BD%8D-Power-control/image-20240806154942748.png" class="">

<img src="/2024/08/06/Cortex-M4%E7%9A%84%E6%97%B6%E9%92%9F-%E5%A4%8D%E4%BD%8D-Power-control/image-20240806155007236.png" class="">


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wzjsdyx.github.io/2024/08/01/Cortex-M4%E7%9A%84%E6%97%B6%E9%92%9F%E5%92%8C%E5%A4%8D%E4%BD%8D%E8%AE%BE%E8%AE%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/animal_toy_cute_doll_teddy_256.png">
      <meta itemprop="name" content="Youngster">
      <meta itemprop="description" content="show me bug">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="芯青年">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/08/01/Cortex-M4%E7%9A%84%E6%97%B6%E9%92%9F%E5%92%8C%E5%A4%8D%E4%BD%8D%E8%AE%BE%E8%AE%A1/" class="post-title-link" itemprop="url">Cortex-M4的时钟和复位设计实战</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-08-01 19:57:54" itemprop="dateCreated datePublished" datetime="2024-08-01T19:57:54+08:00">2024-08-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-08-06 15:55:59" itemprop="dateModified" datetime="2024-08-06T15:55:59+08:00">2024-08-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%9F%BA%E4%BA%8ECortex-M%E7%9A%84SoC%E8%AE%BE%E8%AE%A1/" itemprop="url" rel="index"><span itemprop="name">基于Cortex-M的SoC设计</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%9F%BA%E4%BA%8ECortex-M%E7%9A%84SoC%E8%AE%BE%E8%AE%A1/Cortex-M4-SoC%E8%AE%BE%E8%AE%A1%E5%AE%9E%E6%88%98/" itemprop="url" rel="index"><span itemprop="name">Cortex-M4 SoC设计实战</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/08/01/Cortex-M4%E7%9A%84%E6%97%B6%E9%92%9F%E5%92%8C%E5%A4%8D%E4%BD%8D%E8%AE%BE%E8%AE%A1/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/08/01/Cortex-M4%E7%9A%84%E6%97%B6%E9%92%9F%E5%92%8C%E5%A4%8D%E4%BD%8D%E8%AE%BE%E8%AE%A1/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="core时钟结构"><a href="#core时钟结构" class="headerlink" title="core时钟结构"></a>core时钟结构</h1><img src="/2024/08/01/Cortex-M4%E7%9A%84%E6%97%B6%E9%92%9F%E5%92%8C%E5%A4%8D%E4%BD%8D%E8%AE%BE%E8%AE%A1/image-20240806155352379.png" class="">



<h1 id="core复位结构"><a href="#core复位结构" class="headerlink" title="core复位结构"></a>core复位结构</h1><img src="/2024/08/01/Cortex-M4%E7%9A%84%E6%97%B6%E9%92%9F%E5%92%8C%E5%A4%8D%E4%BD%8D%E8%AE%BE%E8%AE%A1/image-20240806155512611.png" class="">



<h1 id="core-power-control"><a href="#core-power-control" class="headerlink" title="core power control"></a>core power control</h1><img src="/2024/08/01/Cortex-M4%E7%9A%84%E6%97%B6%E9%92%9F%E5%92%8C%E5%A4%8D%E4%BD%8D%E8%AE%BE%E8%AE%A1/image-20240806155534555.png" class="">




      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wzjsdyx.github.io/2024/07/29/IP%E4%B9%8Bdft%E8%AE%BE%E8%AE%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/animal_toy_cute_doll_teddy_256.png">
      <meta itemprop="name" content="Youngster">
      <meta itemprop="description" content="show me bug">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="芯青年">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/07/29/IP%E4%B9%8Bdft%E8%AE%BE%E8%AE%A1/" class="post-title-link" itemprop="url">IP之dft设计</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-07-29 20:53:07" itemprop="dateCreated datePublished" datetime="2024-07-29T20:53:07+08:00">2024-07-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-08-06 16:39:52" itemprop="dateModified" datetime="2024-08-06T16:39:52+08:00">2024-08-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/DFT%E5%8F%AF%E6%B5%8B%E6%80%A7%E8%AE%BE%E8%AE%A1/" itemprop="url" rel="index"><span itemprop="name">DFT可测性设计</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/07/29/IP%E4%B9%8Bdft%E8%AE%BE%E8%AE%A1/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/07/29/IP%E4%B9%8Bdft%E8%AE%BE%E8%AE%A1/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>数字电路最常用的 DFT 技术就是加 scan chain。 用 ATPG 工具产生 scan pattern 可以很高效地判断片子内部是否有缺陷。</p>
<p>能够测试的缺陷一般是：</p>
<ul>
<li>stuck at 错误</li>
<li>transition错误</li>
</ul>
<p>DFT技术的核心就两个词：</p>
<p>1、Controllability 可控性</p>
<p> 2、Observability 可观察性</p>
<p>Design中需要实现可控性以支持DFT技术；</p>
<p>ATPG的test coverage可以用来评估可观察性好坏；</p>
</blockquote>
<h1 id="可控性"><a href="#可控性" class="headerlink" title="可控性"></a>可控性</h1><h2 id="时钟可控"><a href="#时钟可控" class="headerlink" title="时钟可控"></a>时钟可控</h2><ul>
<li>每一个时钟都应该加上 scan mux。在 ATPG mode 下，scan mux 切换到 scan clock 替换功能时钟 (functional clock) 驱动 flip flop。</li>
<li>如果设计中用到 ICG (integrated clock gating) cell， 在 ATPG mode 下 ICG 保持“透明” transparent， 即 scan clock 要畅通无阻通过 ICG。 通常 ICG 会有一个 TE pin，连上 atpg_mode 信号就可以保证每个 scan clock pulse 都通过了。</li>
</ul>
<p>&#x3D;&#x3D;》bypass 内部时钟</p>
<img src="/2024/07/29/IP%E4%B9%8Bdft%E8%AE%BE%E8%AE%A1/image-20240730202209695.png" class="">

<p>&#x3D;&#x3D;》bypass data当做clock的case</p>
<img src="/2024/07/29/IP%E4%B9%8Bdft%E8%AE%BE%E8%AE%A1/image-20240730202119127.png" class="">

<h2 id="复位可控"><a href="#复位可控" class="headerlink" title="复位可控"></a>复位可控</h2><ul>
<li>每一个复位都应该加上 scan mux。在 ATPG mode 下，scan mux 切换到 scan reset 替换功能复位。</li>
<li>如果因为pin 紧张，无法提供 scan reset，可以在 ATPG mode 下把复位 tie 到 1。</li>
</ul>
<p><font color=blue>模块的clock和复位都需要在ATPG mode的时候切换成scan的clock和reset</font></p>
<img src="/2024/07/29/IP%E4%B9%8Bdft%E8%AE%BE%E8%AE%A1/image-20240730201957255.png" class="">



<h1 id="可观察性"><a href="#可观察性" class="headerlink" title="可观察性"></a>可观察性</h1><p>如果电路内部某个 gate 有 stuck at fault，是否都能观察到。 绝大部分 gate 如果有 stuck at fault， 都会被 scan chain 捕捉到。输出的 scan pattern 与预期不一致，就说明片子内部有缺陷了。</p>
<p>ATPG 工具报告中的 test coverage可用来评估可观察性好坏。 如果test coverage % 比较低，就要研究如何让内部更多的信号可以被 scan chain 观察到了。 具体要看是哪部分电路覆盖率低，分析是否设计中有错造成部分 flip flop 没有加到 scan chain 里。 有些 gate 是无法完全覆盖的，如 scan mux, scan tie off。</p>
<p><font color=blue>综合工具插入 scan chain 后通常可以生成 DFT DRC 报告。 要看一下。 如果 DFT DRC 过不了，就是scan有些地方出错了，例如出现不可控的path；</font></p>
<h1 id="项目中的实操"><a href="#项目中的实操" class="headerlink" title="项目中的实操"></a>项目中的实操</h1><p>一般来说，实际项目中会在clock module以及reset module使用scan mux对时钟和复位进行切换；</p>
<h2 id="添加时钟scan-mux-clock-mux"><a href="#添加时钟scan-mux-clock-mux" class="headerlink" title="添加时钟scan mux(clock mux)"></a>添加时钟scan mux(clock mux)</h2><h3 id="case1：模块内部有多个时钟需要切换"><a href="#case1：模块内部有多个时钟需要切换" class="headerlink" title="case1：模块内部有多个时钟需要切换"></a>case1：模块内部有多个时钟需要切换</h3><p>如果一个模块中只有一个时钟，那么模块内部一般就不用scan mux（clock mux）进行切换</p>
<p>如果一个模块内部需要多个时钟，并且需要对其切换进行工作，那么就需要使用scan mux，如下图所示：</p>
<img src="/2024/07/29/IP%E4%B9%8Bdft%E8%AE%BE%E8%AE%A1/image-20240730203811707.png" class="">

<blockquote>
<p>原因是，clk_sel信号来自于某个寄存器，其在scan的过程中是不可控的；</p>
<p>方式一：直接做一个scan mux</p>
<p>方式二：源头上已经对fun_clock1以及fun_clock2做了切换，因此可以对原来的clock select进行控制即可；</p>
</blockquote>
<h3 id="case2：data当做clock"><a href="#case2：data当做clock" class="headerlink" title="case2：data当做clock"></a>case2：data当做clock</h3><p>WIC中data当做clock，就需要进行切换，如下图所示：</p>
<img src="/2024/07/29/IP%E4%B9%8Bdft%E8%AE%BE%E8%AE%A1/image-20240730204220520.png" class="">



<h2 id="添加复位scan-mux-clock-mux"><a href="#添加复位scan-mux-clock-mux" class="headerlink" title="添加复位scan mux(clock mux)"></a>添加复位scan mux(clock mux)</h2><h3 id="case1：data当做reset"><a href="#case1：data当做reset" class="headerlink" title="case1：data当做reset"></a>case1：data当做reset</h3><blockquote>
<p>因为是异步复位同步释放之后的电路；</p>
<p>属于是data当做reset的情况，因此需要添加scan mux；</p>
</blockquote>
<img src="/2024/07/29/IP%E4%B9%8Bdft%E8%AE%BE%E8%AE%A1/image-20240730204805385.png" class="">



<hr>
<p>参考博客：</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://blog.eetop.cn/blog-1592-6946129.html">数字电路DFT</a></li>
<li><a target="_blank" rel="noopener" href="https://www.ip-soc.com/magazine/229.html">DFT的最佳设计实践</a></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wzjsdyx.github.io/2024/07/26/dft%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/animal_toy_cute_doll_teddy_256.png">
      <meta itemprop="name" content="Youngster">
      <meta itemprop="description" content="show me bug">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="芯青年">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/07/26/dft%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/" class="post-title-link" itemprop="url">dft基础概念</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-07-26 15:44:34" itemprop="dateCreated datePublished" datetime="2024-07-26T15:44:34+08:00">2024-07-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-07-30 20:18:14" itemprop="dateModified" datetime="2024-07-30T20:18:14+08:00">2024-07-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/DFT%E5%8F%AF%E6%B5%8B%E6%80%A7%E8%AE%BE%E8%AE%A1/" itemprop="url" rel="index"><span itemprop="name">DFT可测性设计</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/07/26/dft%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/07/26/dft%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="基础概念"><a href="#基础概念" class="headerlink" title="基础概念"></a>基础概念</h1><p>芯片</p>
<h1 id="寄存器的测试"><a href="#寄存器的测试" class="headerlink" title="寄存器的测试"></a>寄存器的测试</h1><p><font color=blue>寄存器的测试需要插入一条scan链，将所有的寄存器连接起来。</font></p>
<p>1、原来的function逻辑</p>
<img src="/2024/07/26/dft%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/image-20240727112627887.png" class="">

<p>2、插入scan链需要使用scan寄存器</p>
<img src="/2024/07/26/dft%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/image-20240727112828088.png" class="">

<p>3、插入扫描链的示意图</p>
<img src="/2024/07/26/dft%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/image-20240727112943729.png" class="">







<p>SCAN链和ATPG测试向量</p>
<p>ATPG主要是覆盖两种错误：</p>
<p>1、stuck at 错误</p>
<p>2、transition错误</p>
<p>其中：</p>
<p>stuck at的错误可以通过scan测试来解决，其使用的是低速时钟；</p>
<p>transition错误可以通过transition测试来解决，需要低速scan时钟和高速at speed时钟的切换，会使用OCC IP；</p>
<p>OCC的用途</p>
<p>OCC是片内时钟控制器，在DFT模式下可以进行低速scan时钟和高速at speed时钟的切换</p>
<h1 id="SRAM-ROM-Macro的测试"><a href="#SRAM-ROM-Macro的测试" class="headerlink" title="SRAM&#x2F;ROM Macro的测试"></a>SRAM&#x2F;ROM Macro的测试</h1><p>Memory bist</p>
<h1 id="Flash-Macro的测试"><a href="#Flash-Macro的测试" class="headerlink" title="Flash Macro的测试"></a>Flash Macro的测试</h1><ul>
<li><p>使用vendor专门提供的的BIST IP（具有专门的JTAG接口）进行测试</p>
</li>
<li><p>需要开发Flash测试pattern</p>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wzjsdyx.github.io/2024/07/26/JTAG-SWD-ACK-error/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/animal_toy_cute_doll_teddy_256.png">
      <meta itemprop="name" content="Youngster">
      <meta itemprop="description" content="show me bug">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="芯青年">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/07/26/JTAG-SWD-ACK-error/" class="post-title-link" itemprop="url">JTAG/SWD ACK=error</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-07-26 13:52:50 / 修改时间：15:42:14" itemprop="dateCreated datePublished" datetime="2024-07-26T13:52:50+08:00">2024-07-26</time>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/07/26/JTAG-SWD-ACK-error/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/07/26/JTAG-SWD-ACK-error/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>在对JTAG&#x2F;SWD仿真的时候，经常会遇到ACK error的情况，现在对一些会导致ACK error的场景做总结；</p>
<p>一般来说不是IP本身的问题，需要对时钟，timing等等做check</p>
</blockquote>
<p>错误case1：判断DAP是否有时钟</p>
<p>错误case2：判断DP是否有transaction到AP</p>
<p>错误case3：判断AP是否有transaction通过总线打出</p>
<p>错误case4：判断JTAG&#x2F;SWD的约束timing是否满足</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wzjsdyx.github.io/2024/07/23/verilog%E4%B9%8B%E5%A5%87%E5%A5%87%E6%80%AA%E6%80%AA%E7%9A%84%E7%82%B9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/animal_toy_cute_doll_teddy_256.png">
      <meta itemprop="name" content="Youngster">
      <meta itemprop="description" content="show me bug">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="芯青年">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/07/23/verilog%E4%B9%8B%E5%A5%87%E5%A5%87%E6%80%AA%E6%80%AA%E7%9A%84%E7%82%B9/" class="post-title-link" itemprop="url">verilog之奇奇怪怪的注意点</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-07-23 17:53:00" itemprop="dateCreated datePublished" datetime="2024-07-23T17:53:00+08:00">2024-07-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-07-24 14:34:11" itemprop="dateModified" datetime="2024-07-24T14:34:11+08:00">2024-07-24</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/07/23/verilog%E4%B9%8B%E5%A5%87%E5%A5%87%E6%80%AA%E6%80%AA%E7%9A%84%E7%82%B9/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/07/23/verilog%E4%B9%8B%E5%A5%87%E5%A5%87%E6%80%AA%E6%80%AA%E7%9A%84%E7%82%B9/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="force语句"><a href="#force语句" class="headerlink" title="force语句"></a>force语句</h2><p>如果对wire就行force，那么整个wire逻辑都会是被传递；</p>
<h2 id="判断语句"><a href="#判断语句" class="headerlink" title="&#x3D;&#x3D; 判断语句"></a>&#x3D;&#x3D; 判断语句</h2><p>如果32bits data中，高bit是Z或者X，那么在进行比较的时候，就可能出现问题；</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">wait</span>(top_sim<span class="variable">.ac7843x</span><span class="variable">.MTCMOS_wrap</span><span class="variable">.protsys</span><span class="variable">.pbr_right_inf_u</span><span class="variable">.master3_right</span>[<span class="number">31</span>:<span class="number">0</span>] == <span class="number">32&#x27;h6</span>);</span><br><span class="line"># 在上述语句中，如果只有低<span class="number">3</span>bits有效，高<span class="number">29</span>bits是Z态，那么上面的比较就不会成立，可能会一直比较，修改进行如下的修改：</span><br><span class="line"><span class="keyword">wait</span>(top_sim<span class="variable">.ac7843x</span><span class="variable">.MTCMOS_wrap</span><span class="variable">.protsys</span><span class="variable">.pbr_right_inf_u</span><span class="variable">.master3_right</span>[<span class="number">2</span>:<span class="number">0</span>] == <span class="number">3&#x27;b110</span>);</span><br></pre></td></tr></table></figure>



<h2 id="波形dump"><a href="#波形dump" class="headerlink" title="波形dump"></a>波形dump</h2><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$fsdbAutoSwitchDumpfile(<span class="number">100</span>,<span class="string">&quot;top_sim.fsdb&quot;</span>,<span class="number">200</span>);</span><br><span class="line">$fsdbDumpvars(<span class="number">0</span>, top_sim,<span class="string">&quot;+mda&quot;</span>);</span><br></pre></td></tr></table></figure>



<img src="/2024/07/23/verilog%E4%B9%8B%E5%A5%87%E5%A5%87%E6%80%AA%E6%80%AA%E7%9A%84%E7%82%B9/image-20240724121740011.png" class="">



<p>$fsdbDumpvars</p>
<p>depth表示要加载波形的层次；0表示当前instance下的所有变量一级其他module实例的波形，1表示当前instance中的变量的波形，不包括当前instance中的其他module实例的波形，2表示包含当前instance以及其中的第一级子instance的波形；以此类推。</p>
<p>$fsdbAutoSwitchDumpfile(File_Size,”file_name”, Max_file_number[, log_file_name])</p>
<p>file_size的单位是M。log file是可选的，建议加上。</p>
<h2 id="反标延时"><a href="#反标延时" class="headerlink" title="反标延时"></a>反标延时</h2><p>$sdf_annotate</p>
<hr>
<p>参考博客：</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/909f4d15a1c4">fsdbAutoSwitchDumpfile</a></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wzjsdyx.github.io/2024/07/23/trace%E6%97%B6%E5%BA%8F%E7%BA%A6%E6%9D%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/animal_toy_cute_doll_teddy_256.png">
      <meta itemprop="name" content="Youngster">
      <meta itemprop="description" content="show me bug">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="芯青年">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/07/23/trace%E6%97%B6%E5%BA%8F%E7%BA%A6%E6%9D%9F/" class="post-title-link" itemprop="url">trace时序约束</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-07-23 16:27:47" itemprop="dateCreated datePublished" datetime="2024-07-23T16:27:47+08:00">2024-07-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-07-26 14:00:22" itemprop="dateModified" datetime="2024-07-26T14:00:22+08:00">2024-07-26</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/07/23/trace%E6%97%B6%E5%BA%8F%E7%BA%A6%E6%9D%9F/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/07/23/trace%E6%97%B6%E5%BA%8F%E7%BA%A6%E6%9D%9F/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="时序约束原则"><a href="#时序约束原则" class="headerlink" title="时序约束原则"></a>时序约束原则</h1><img src="/2024/07/23/trace%E6%97%B6%E5%BA%8F%E7%BA%A6%E6%9D%9F/image-20240726135903139.png" class="">

<img src="/2024/07/23/trace%E6%97%B6%E5%BA%8F%E7%BA%A6%E6%9D%9F/image-20240726135930695.png" class="">

<img src="/2024/07/23/trace%E6%97%B6%E5%BA%8F%E7%BA%A6%E6%9D%9F/image-20240726135943324.png" class="">


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wzjsdyx.github.io/2024/07/22/WIC%E5%8E%9F%E7%90%86%E5%9B%BE-%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%88%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/animal_toy_cute_doll_teddy_256.png">
      <meta itemprop="name" content="Youngster">
      <meta itemprop="description" content="show me bug">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="芯青年">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/07/22/WIC%E5%8E%9F%E7%90%86%E5%9B%BE-%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%88%B6/" class="post-title-link" itemprop="url">WIC原理图&工作机制</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-07-22 20:38:51" itemprop="dateCreated datePublished" datetime="2024-07-22T20:38:51+08:00">2024-07-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-08-07 09:49:34" itemprop="dateModified" datetime="2024-08-07T09:49:34+08:00">2024-08-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Cortex-M4/" itemprop="url" rel="index"><span itemprop="name">Cortex-M4</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/07/22/WIC%E5%8E%9F%E7%90%86%E5%9B%BE-%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%88%B6/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/07/22/WIC%E5%8E%9F%E7%90%86%E5%9B%BE-%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%88%B6/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="demo-WIC原理图"><a href="#demo-WIC原理图" class="headerlink" title="demo WIC原理图"></a>demo WIC原理图</h1><img src="/2024/07/22/WIC%E5%8E%9F%E7%90%86%E5%9B%BE-%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%88%B6/image-20240807093513039.png" class="">

<img src="/2024/07/22/WIC%E5%8E%9F%E7%90%86%E5%9B%BE-%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%88%B6/image-20240807093701230.png" class="">



<blockquote>
<p>1、WIC CLEAR的时候写0<br>2、WIC active以及有中断的时候，写1</p>
</blockquote>
<h1 id="修改后的WIC原理图"><a href="#修改后的WIC原理图" class="headerlink" title="修改后的WIC原理图"></a>修改后的WIC原理图</h1><img src="/2024/07/22/WIC%E5%8E%9F%E7%90%86%E5%9B%BE-%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%88%B6/image-20240807093612230.png" class="">

<img src="/2024/07/22/WIC%E5%8E%9F%E7%90%86%E5%9B%BE-%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%88%B6/image-20240807093729352.png" class="">



<blockquote>
<p>1、WIC LOAD时，wic_active寄存器拉高；wic_pend_we也会拉高;<br>此时中断没有到来，WICPEND寄存器没有时钟；<br>2、当某个中断[i]到来的时候，此时寄存器有时钟，对应的WICPEND[i]会写1<br>3、当WIC_CLEAR或者复位的时候，WICPEND[i]会被清除</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wzjsdyx.github.io/2024/07/22/Cortex-M4%E7%89%B9%E6%9D%83%E7%BA%A7%E8%BD%AC%E6%8D%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/animal_toy_cute_doll_teddy_256.png">
      <meta itemprop="name" content="Youngster">
      <meta itemprop="description" content="show me bug">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="芯青年">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/07/22/Cortex-M4%E7%89%B9%E6%9D%83%E7%BA%A7%E8%BD%AC%E6%8D%A2/" class="post-title-link" itemprop="url">Cortex-M4特权级转换</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-07-22 11:11:28" itemprop="dateCreated datePublished" datetime="2024-07-22T11:11:28+08:00">2024-07-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-07-26 14:00:35" itemprop="dateModified" datetime="2024-07-26T14:00:35+08:00">2024-07-26</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/07/22/Cortex-M4%E7%89%B9%E6%9D%83%E7%BA%A7%E8%BD%AC%E6%8D%A2/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/07/22/Cortex-M4%E7%89%B9%E6%9D%83%E7%BA%A7%E8%BD%AC%E6%8D%A2/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Youngster"
      src="/images/animal_toy_cute_doll_teddy_256.png">
  <p class="site-author-name" itemprop="name">Youngster</p>
  <div class="site-description" itemprop="description">show me bug</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">140</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">35</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">138</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Youngster</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : '3qPpN2UkBU7Q1vhWnH1WdrQZ-gzGzoHsz',
      appKey     : 'LAapaVzfFkIj1knpaWSWCNDo',
      placeholder: "Looking forward to communication.",
      avatar     : 'monsterid',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
