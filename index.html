<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/animal_toy_cute_doll_teddy_72.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/animal_toy_cute_doll_teddy_72.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"wzjsdyx.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="show me bug">
<meta property="og:type" content="website">
<meta property="og:title" content="芯青年">
<meta property="og:url" content="https://wzjsdyx.github.io/index.html">
<meta property="og:site_name" content="芯青年">
<meta property="og:description" content="show me bug">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Youngster">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://wzjsdyx.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>芯青年</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">芯青年</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wzjsdyx.github.io/2024/06/11/python%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/animal_toy_cute_doll_teddy_256.png">
      <meta itemprop="name" content="Youngster">
      <meta itemprop="description" content="show me bug">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="芯青年">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/06/11/python%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/" class="post-title-link" itemprop="url">python基础语法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-06-11 15:01:33 / 修改时间：15:05:30" itemprop="dateCreated datePublished" datetime="2024-06-11T15:01:33+08:00">2024-06-11</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%84%9A%E6%9C%AC/" itemprop="url" rel="index"><span itemprop="name">脚本</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%84%9A%E6%9C%AC/python%E8%84%9A%E6%9C%AC/" itemprop="url" rel="index"><span itemprop="name">python脚本</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/06/11/python%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/06/11/python%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="条件分支"><a href="#条件分支" class="headerlink" title="条件分支"></a>条件分支</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> condition1:</span><br><span class="line">    <span class="comment"># statement1</span></span><br><span class="line"><span class="keyword">elif</span> condition2:</span><br><span class="line">    <span class="comment"># statement2</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="comment">#statement3</span></span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wzjsdyx.github.io/2024/06/07/verilog%E6%9D%A1%E4%BB%B6%E7%BC%96%E8%AF%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/animal_toy_cute_doll_teddy_256.png">
      <meta itemprop="name" content="Youngster">
      <meta itemprop="description" content="show me bug">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="芯青年">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/06/07/verilog%E6%9D%A1%E4%BB%B6%E7%BC%96%E8%AF%91/" class="post-title-link" itemprop="url">verilog条件编译</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-06-07 11:38:37" itemprop="dateCreated datePublished" datetime="2024-06-07T11:38:37+08:00">2024-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-11 15:04:51" itemprop="dateModified" datetime="2024-06-11T15:04:51+08:00">2024-06-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/verilog%E8%AF%AD%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">verilog语法</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/06/07/verilog%E6%9D%A1%E4%BB%B6%E7%BC%96%E8%AF%91/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/06/07/verilog%E6%9D%A1%E4%BB%B6%E7%BC%96%E8%AF%91/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wzjsdyx.github.io/2024/06/07/%E8%BD%A6%E8%A7%84MCU-bootrom-%E9%AA%8C%E8%AF%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/animal_toy_cute_doll_teddy_256.png">
      <meta itemprop="name" content="Youngster">
      <meta itemprop="description" content="show me bug">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="芯青年">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/06/07/%E8%BD%A6%E8%A7%84MCU-bootrom-%E9%AA%8C%E8%AF%81/" class="post-title-link" itemprop="url">车规MCU bootrom 验证</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-06-07 10:36:27" itemprop="dateCreated datePublished" datetime="2024-06-07T10:36:27+08:00">2024-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-11 14:41:04" itemprop="dateModified" datetime="2024-06-11T14:41:04+08:00">2024-06-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%BD%A6%E8%A7%84MCU/" itemprop="url" rel="index"><span itemprop="name">车规MCU</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/06/07/%E8%BD%A6%E8%A7%84MCU-bootrom-%E9%AA%8C%E8%AF%81/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/06/07/%E8%BD%A6%E8%A7%84MCU-bootrom-%E9%AA%8C%E8%AF%81/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>车规MCU需要HSM信息安全，其实现方式有可能会利用到host bootrom</p>
<p>一个不懂的东西，怎么去快速了解上手？</p>
<p>1、需要自己看看已有的资料有一定的认知；</p>
<p>2、私下问下同事，询问不懂的问题；</p>
<p>2、开会和其他同事同步，进一步加深理解；</p>
<p>3、总结思考实践–&gt;有自己的认知；</p>
</blockquote>
<h1 id="host-bootrom功能描述"><a href="#host-bootrom功能描述" class="headerlink" title="host bootrom功能描述"></a>host bootrom功能描述</h1><p>主要提供normal boot和secure boot的功能</p>
<p>BootRom需要使用GPIO，Uart，HSM message box等模块。</p>
<h1 id="测试流程"><a href="#测试流程" class="headerlink" title="测试流程"></a>测试流程</h1><p>&#x3D;&#x3D;》load config只是从flash info区域读取数据，不care OTP区域；</p>
<p><font color=blue>hsm enable以及secure boot是通过读取寄存器</font>？也不用care OTP区域；</p>
<p><font color=red>读取寄存器？读取什么寄存器？</font></p>
<p>&#x3D;&#x3D;》init debug表明是否需要打印log（optional，默认disable）</p>
<p>要打印log就初始化UART串口；不需要打印log就不初始化UART串口；</p>
<p>&#x3D;&#x3D;》rom code的执行是否需要切换成系统时钟（optional，默认enable）</p>
<p>切换成PLL提供的系统时钟，处理速度就比较快，加速启动时间</p>
<p>启动PLL也就是初始化PLL大概需要100us的时间</p>
<p><font color=red>系统时钟：从什么时钟切换到PLL时钟？？？</font></p>
<h2 id="non-security-boot"><a href="#non-security-boot" class="headerlink" title="non-security boot"></a>non-security boot</h2><p>&#x3D;&#x3D;》两个secure boot check？</p>
<p>security boot分成两部分：一个是启动校验，一个是等待校验结果</p>
<p>所以流程图上有两个security boot check框</p>
<p>&#x3D;&#x3D;》Restore debug and clock(Optional)</p>
<p>关闭UART以及将系统时钟切回去</p>
<p>&#x3D;&#x3D;》jump to user code</p>
<p>跳转到pflash的user code（default是0x20_0000）</p>
<ul>
<li><p>user code可以配置从pflash的info区域执行；</p>
</li>
<li><p>user code可以配置从pflash的main区域执行；</p>
</li>
</ul>
<p>执行user code</p>
<h2 id="security-boot"><a href="#security-boot" class="headerlink" title="security boot"></a>security boot</h2><p>&#x3D;&#x3D;》 security boot需要很多的配置信息，首先需要确认配置信息是否正确（主要是对地址以及size的有效性进行检查）</p>
<p>&#x3D;&#x3D;》等待HSM ready</p>
<p>&#x3D;&#x3D;》执行check code（<font color=blue>校验用户代码的代码</font>），通过发命令到HSM，（主要是校验地址，校验size以及校验算法），让其开始校验<font color=blue>用户代码</font></p>
<p>&#x3D;&#x3D;》等待check结果（done，pass&#x2F;fail）</p>
<p>正确就继续执行下面的流程，即走启动用户代码的流程；</p>
<p>错误就执行while 1 （default的行为），也可配置成system reset，通过watch dog进行复位；</p>
<p>吴奎那边有现成的工具可以做对应的测试；</p>
<h1 id="Q-A"><a href="#Q-A" class="headerlink" title="Q&amp;A"></a>Q&amp;A</h1><p>&#x3D;&#x3D;》什么时候出现check error</p>
<p>将需要校验的代码，手动修改成错误数据</p>
<blockquote>
<p>校验算法是通过OTP配置好的</p>
<p>校验的地址和size都是在info区域配置的</p>
</blockquote>
<p>&#x3D;&#x3D;》standby boot</p>
<p>pflash user code进入standby模式之后，默认还会执行security boot校验（optional可配置）</p>
<p>&#x3D;&#x3D;》用户代码和被校验的代码</p>
<p>安全启动的时候就是被校验的代码</p>
<p>没有安全启动的时候就是未被校验的代码，即用户代码</p>
<p>&#x3D;&#x3D;》默认是不swap的</p>
<p>swap之后，如下图这些配置起始地址就会从0x01004800–&gt;0x01005000，offset不变</p>
<img src="/2024/06/07/%E8%BD%A6%E8%A7%84MCU-bootrom-%E9%AA%8C%E8%AF%81/image-20240611113255222.png" class="">



<p>&#x3D;&#x3D;》security boot的参数比较多</p>
<p>hsm security boot的各个参数是绑定到一起的，通常来说错一个都会导致HSM check error</p>
<p>&#x3D;&#x3D;》SOTA功能测试</p>
<p>有两个配置区域，一个是正确的配置，一个是错误的配置；</p>
<p>通过配置SOTA enable还是disable可以进行不同的测试；</p>
<p>&#x3D;&#x3D;》HSM安全启动测试</p>
<p>不同的校验算法都校验成功；</p>
<p>根据hsm的算法，去校验什么东西，然后做对应的配置；</p>
<p>询问HSM的人，怎么把算法用起来；</p>
<p>例如：key需要配置什么东西，验签signature需要设置什么东西和算法相关，使用什么算法，就需要根据对应的算法做相应的配置</p>
<h2 id="pflash-info-HSM-security-boot各项配置参数的含义"><a href="#pflash-info-HSM-security-boot各项配置参数的含义" class="headerlink" title="pflash info:HSM security boot各项配置参数的含义"></a>pflash info:HSM security boot各项配置参数的含义</h2><h2 id="dflash-info-OTP各项配置参数的含义"><a href="#dflash-info-OTP各项配置参数的含义" class="headerlink" title="dflash info:OTP各项配置参数的含义"></a>dflash info:OTP各项配置参数的含义</h2><h2 id="SOTA机制"><a href="#SOTA机制" class="headerlink" title="SOTA机制"></a>SOTA机制</h2><h2 id="boot-flow-数据流"><a href="#boot-flow-数据流" class="headerlink" title="boot flow&#x2F;数据流"></a>boot flow&#x2F;数据流</h2><p>例如，host core先动起来，执行host romcode代码，然后加载pflash info区域的值；</p>
<p>然后判断是否为security boot，如果是的话，发送command，去调动hsm做校验；</p>
<p><font color=red>hsm根据OTP的value去使用相应的算法做校验？？？具体的流程是什么样？</font></p>
<h2 id="测试item"><a href="#测试item" class="headerlink" title="测试item"></a>测试item</h2><p>配置选项&#x2F;输入条件</p>
<p>check point？</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wzjsdyx.github.io/2024/06/07/apb-sync-unit/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/animal_toy_cute_doll_teddy_256.png">
      <meta itemprop="name" content="Youngster">
      <meta itemprop="description" content="show me bug">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="芯青年">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/06/07/apb-sync-unit/" class="post-title-link" itemprop="url">apb_sync_unit</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-06-07 09:27:24" itemprop="dateCreated datePublished" datetime="2024-06-07T09:27:24+08:00">2024-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-11 15:05:05" itemprop="dateModified" datetime="2024-06-11T15:05:05+08:00">2024-06-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/IC%E7%94%B5%E8%B7%AF%E8%AE%BE%E8%AE%A1tips/" itemprop="url" rel="index"><span itemprop="name">IC电路设计tips</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/06/07/apb-sync-unit/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/06/07/apb-sync-unit/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>项目中可能需要对APB协议进行CDC的设计，简单的方法是通过使用ready信号反压来实现；</p>
</blockquote>
<h1 id="RTL代码实现"><a href="#RTL代码实现" class="headerlink" title="RTL代码实现"></a>RTL代码实现</h1><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> apb_sync_unit(</span><br><span class="line">  <span class="keyword">input</span>  psel       ,</span><br><span class="line">  <span class="keyword">input</span>  pwrite     ,</span><br><span class="line">  <span class="keyword">input</span>  pclk       ,</span><br><span class="line">  <span class="keyword">input</span>  fclk       ,</span><br><span class="line">  <span class="keyword">input</span>  prst_b     ,</span><br><span class="line">  <span class="keyword">input</span>  frst_b     ,</span><br><span class="line">  <span class="keyword">output</span> psel_sync  ,</span><br><span class="line">  <span class="keyword">output</span> pready     </span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line"><span class="comment">//apb valid from pclk</span></span><br><span class="line"><span class="keyword">reg</span> psel_d;</span><br><span class="line"><span class="keyword">always</span>@(<span class="keyword">posedge</span> pclk <span class="keyword">or</span> <span class="keyword">negedge</span> prst_b)</span><br><span class="line">  <span class="keyword">if</span>(!prst_b)</span><br><span class="line">    psel_d &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    psel_d &lt;= psel;</span><br><span class="line"></span><br><span class="line"><span class="keyword">wire</span> psel_pos = (!psel_d) &amp; psel;</span><br><span class="line"></span><br><span class="line"><span class="keyword">reg</span> ptrans;</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> pclk <span class="keyword">or</span> <span class="keyword">negedge</span> prst_b)</span><br><span class="line">  <span class="keyword">if</span>(!prst_b)</span><br><span class="line">    ptrans &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (psel_pos)</span><br><span class="line">    ptrans &lt;= ~ptrans;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ptrans sync to fclk domain</span></span><br><span class="line"><span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>] ptrans_sync;</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> fclk <span class="keyword">or</span> <span class="keyword">negedge</span> frst_b)</span><br><span class="line">  <span class="keyword">if</span>(!frst_b)</span><br><span class="line">    ptrans_sync &lt;= <span class="number">3&#x27;b0</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    ptrans_sync &lt;=&#123;ptrans_sync[<span class="number">1</span>:<span class="number">0</span>],ptrans&#125;;</span><br><span class="line"><span class="keyword">assign</span> psel_sync = ptrans_sync[<span class="number">2</span>] ^ ptrans_sync[<span class="number">1</span>];<span class="comment">//both trigger</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ptrans sync back to pclk</span></span><br><span class="line"><span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>] ptrans_sync_pclk;</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> pclk <span class="keyword">or</span> <span class="keyword">negedge</span> prst_b)</span><br><span class="line">  <span class="keyword">if</span>(!prst_b)</span><br><span class="line">    ptrans_sync_pclk &lt;= <span class="number">3&#x27;b0</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    ptrans_sync_pclk &lt;=&#123;ptrans_sync_pclk[<span class="number">1</span>:<span class="number">0</span>],ptrans_sync[<span class="number">2</span>]&#125;;</span><br><span class="line"><span class="keyword">wire</span> pready_comb  = ptrans_sync_pclk[<span class="number">2</span>] ^ ptrans_sync_pclk[<span class="number">1</span>];<span class="comment">//bothedge trigger</span></span><br><span class="line"><span class="keyword">assign</span> pready = psel ? pready_comb : <span class="number">1&#x27;b1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<h1 id="电路解析"><a href="#电路解析" class="headerlink" title="电路解析"></a>电路解析</h1><img src="/2024/06/07/apb-sync-unit/image-20240607093602194.png" class="">



<h1 id="使用限制"><a href="#使用限制" class="headerlink" title="使用限制"></a>使用限制</h1><blockquote>
<p>apb_sync_unit只使用了psel信号，  通过检测其上升沿从而进行同步，使用时需要保证连续的apb transaction之间，psel信号不会一直为高；</p>
<p>（之前的项目中，外设APB接口协议实现的可能不标准，没有penable，因此sync电路只用了psel进行实现）；</p>
</blockquote>
<p>&#x3D;&#x3D;》如果连续多比apb transaction过程中psel一直为高，会导致pready信号一直拉低，如下图所示是一个先写后读的时序：</p>
<p>错误分析：第一笔写操作，能够回pready；</p>
<p>​             	  第二笔读操作，sync电路检测由于psel&#x3D;1’b1是连续的，检测不到pos，因此当前读操作得不到处理，会导致pready一直拉低</p>
<img src="/2024/06/07/apb-sync-unit/image-20240607093744708.png" class="">



<p><font color=blue>为了处理 连续的apb transaction，psel一直为高  可以参考如下几种做法</font></p>
<h2 id="改进方式1"><a href="#改进方式1" class="headerlink" title="改进方式1"></a>改进方式1</h2><blockquote>
<p>APB接口有penable信号，不改动apb_sync_unit</p>
</blockquote>
<img src="/2024/06/07/apb-sync-unit/image-20240607094323521.png" class="">

<img src="/2024/06/07/apb-sync-unit/image-20240607094352996.png" class="">





<h2 id="改进方式2"><a href="#改进方式2" class="headerlink" title="改进方式2"></a>改进方式2</h2><blockquote>
<p>APB接口有penable信号，  改动apb_sync_unit</p>
</blockquote>
<img src="/2024/06/07/apb-sync-unit/image-20240607094437852.png" class="">

<img src="/2024/06/07/apb-sync-unit/image-20240607094442804.png" class="">



<h2 id="改进方式3"><a href="#改进方式3" class="headerlink" title="改进方式3"></a>改进方式3</h2><blockquote>
<p>APB接口没有penable信号， 改动apb_sync_unit</p>
</blockquote>
<img src="/2024/06/07/apb-sync-unit/image-20240607094502525.png" class="">

<img src="/2024/06/07/apb-sync-unit/image-20240607094506574.png" class="">



<h1 id="时序约束"><a href="#时序约束" class="headerlink" title="时序约束"></a>时序约束</h1><blockquote>
<p>APB同步：根据同步之后的psel信号，去抓address phase的控制信号。</p>
<p>如果时钟频率很快，T&#x3D;2ns，假设psel经过2拍同步，那么会经过4ns的时间，从clock domain1 到clock domain 2,；</p>
<p>假设psel sync之后，其他的控制信号例如pwrite，padd等，还没有到达clock domain2（绕线之后，可能有多达到10ns的delay）。那么就会出现错误状态！！！</p>
<p>可能出现在高制程，频率很快的设计中；例如BUS内部的信号可能走线会很远，导致这种情况的发生！</p>
</blockquote>
<img src="/2024/06/07/apb-sync-unit/image-20240607095127922.png" class="">


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wzjsdyx.github.io/2024/06/05/MCU%E5%85%B3%E7%94%B5%E4%B8%8A%E7%94%B5%E6%B5%81%E7%A8%8B%E5%8F%8A%E5%85%B6%E6%97%B6%E5%BA%8F%E5%88%86%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/animal_toy_cute_doll_teddy_256.png">
      <meta itemprop="name" content="Youngster">
      <meta itemprop="description" content="show me bug">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="芯青年">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/06/05/MCU%E5%85%B3%E7%94%B5%E4%B8%8A%E7%94%B5%E6%B5%81%E7%A8%8B%E5%8F%8A%E5%85%B6%E6%97%B6%E5%BA%8F%E5%88%86%E6%9E%90/" class="post-title-link" itemprop="url">MCU关电上电流程及其时序分析</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-06-05 12:17:32 / 修改时间：17:27:23" itemprop="dateCreated datePublished" datetime="2024-06-05T12:17:32+08:00">2024-06-05</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%BD%8E%E5%8A%9F%E8%80%97%E8%AE%BE%E8%AE%A1/" itemprop="url" rel="index"><span itemprop="name">低功耗设计</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/06/05/MCU%E5%85%B3%E7%94%B5%E4%B8%8A%E7%94%B5%E6%B5%81%E7%A8%8B%E5%8F%8A%E5%85%B6%E6%97%B6%E5%BA%8F%E5%88%86%E6%9E%90/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/06/05/MCU%E5%85%B3%E7%94%B5%E4%B8%8A%E7%94%B5%E6%B5%81%E7%A8%8B%E5%8F%8A%E5%85%B6%E6%97%B6%E5%BA%8F%E5%88%86%E6%9E%90/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="关电和上电顺序"><a href="#关电和上电顺序" class="headerlink" title="关电和上电顺序"></a>关电和上电顺序</h1><p>关电的顺序：<br>1、关闭时钟–》PWR_CLKEN<br>2、拉住reset<br>3、打开ISO–》PWR_ISOON<br>4、关闭Power–》PWR_ON<br>上电的顺序：<br>反过来</p>
<hr>
<p>1、PMU&#x2F;SPM模块enable WIC</p>
<p>2、core执行WFI进入deepsleep mode，此时会自动gating core clock</p>
<p>3、spm wait cache idle（7843 特殊flow）</p>
<p>4、spm走休眠，发出sleep request，wait ACK（就是cache idle以及外设sleep ACK）</p>
<p>5、关闭时钟–》PWR_CLKEN（spm CORE_CLK_EN）</p>
<p>6、<font color=red>拉住reset–》STDBY_PWR_RSTON</font></p>
<p>7、打开ISO–》PWR_ISOON<br>8、关闭Power–》PWR_ON</p>
<p>sleepdeep_gatclk ？ 1’b1 :  (~cm4_sleepdeep) ;</p>
<hr>
<p>正确的case(保存波形，_s1)</p>
<p>复现spm问题(保存波形，_s2)1’吧</p>
<p>修改代码</p>
<p>重新运行</p>
<blockquote>
<p>问题：进不去standby mode，spm 发出sleep request ，等待ACK超时，进入standby失败，CPU自动退出低功耗模式；</p>
</blockquote>
<p><img src="D:\blog\wzjsdyx.github.io\source_posts\2024-06-05-MCU关电上电流程及其时序分析\image-20240605172723153.png" alt="image-20240605172723153"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wzjsdyx.github.io/2024/06/05/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5-debugger%E6%97%A0%E6%B3%95%E8%BF%9E%E6%8E%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/animal_toy_cute_doll_teddy_256.png">
      <meta itemprop="name" content="Youngster">
      <meta itemprop="description" content="show me bug">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="芯青年">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/06/05/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5-debugger%E6%97%A0%E6%B3%95%E8%BF%9E%E6%8E%A5/" class="post-title-link" itemprop="url">项目实践-debugger无法连接</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-06-05 12:16:16 / 修改时间：12:35:09" itemprop="dateCreated datePublished" datetime="2024-06-05T12:16:16+08:00">2024-06-05</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CoreSight/" itemprop="url" rel="index"><span itemprop="name">CoreSight</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/06/05/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5-debugger%E6%97%A0%E6%B3%95%E8%BF%9E%E6%8E%A5/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/06/05/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5-debugger%E6%97%A0%E6%B3%95%E8%BF%9E%E6%8E%A5/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>问题：外部调试器无法连接芯片</p>
<p>现象：debugger read id之后，power up状态不对</p>
</blockquote>
<h1 id="外部debugger和芯片的连接顺序"><a href="#外部debugger和芯片的连接顺序" class="headerlink" title="外部debugger和芯片的连接顺序"></a>外部debugger和芯片的连接顺序</h1><h2 id="SWJ-DP-TAP-reset"><a href="#SWJ-DP-TAP-reset" class="headerlink" title="SWJ-DP TAP reset"></a>SWJ-DP TAP reset</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wzjsdyx.github.io/2024/06/02/2024%E5%B9%B4%E5%BA%A6%E8%AE%A1%E5%88%92/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/animal_toy_cute_doll_teddy_256.png">
      <meta itemprop="name" content="Youngster">
      <meta itemprop="description" content="show me bug">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="芯青年">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/06/02/2024%E5%B9%B4%E5%BA%A6%E8%AE%A1%E5%88%92/" class="post-title-link" itemprop="url">2024年度计划</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-06-02 10:40:32 / 修改时间：11:08:10" itemprop="dateCreated datePublished" datetime="2024-06-02T10:40:32+08:00">2024-06-02</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%B9%B4%E5%BA%A6%E8%AE%A1%E5%88%92/" itemprop="url" rel="index"><span itemprop="name">年度计划</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/06/02/2024%E5%B9%B4%E5%BA%A6%E8%AE%A1%E5%88%92/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/06/02/2024%E5%B9%B4%E5%BA%A6%E8%AE%A1%E5%88%92/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          Here's something encrypted, password is required to continue reading.
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2024/06/02/2024%E5%B9%B4%E5%BA%A6%E8%AE%A1%E5%88%92/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wzjsdyx.github.io/2024/05/28/smic-auto-eflash-bist/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/animal_toy_cute_doll_teddy_256.png">
      <meta itemprop="name" content="Youngster">
      <meta itemprop="description" content="show me bug">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="芯青年">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/05/28/smic-auto-eflash-bist/" class="post-title-link" itemprop="url">smic auto eflash bist</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-05-28 13:36:38" itemprop="dateCreated datePublished" datetime="2024-05-28T13:36:38+08:00">2024-05-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-07 09:24:43" itemprop="dateModified" datetime="2024-06-07T09:24:43+08:00">2024-06-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/eflash/" itemprop="url" rel="index"><span itemprop="name">eflash</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/eflash/eflash-bist/" itemprop="url" rel="index"><span itemprop="name">eflash bist</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/05/28/smic-auto-eflash-bist/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/05/28/smic-auto-eflash-bist/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><font color=blue>相关文档学习</font></p>
<h1 id="DOC–-SMIC-Serial-Testing-Bus"><a href="#DOC–-SMIC-Serial-Testing-Bus" class="headerlink" title="DOC–&gt;SMIC Serial Testing Bus"></a>DOC–&gt;SMIC Serial Testing Bus</h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>The Serial Testing Bus(STB) module 用于测试如下两个eflash Macro：</p>
<ul>
<li>pfm_340sa128kx150_v1Flash Macro </li>
<li>pfm_340sa8kx150_v1Flash Macro.</li>
</ul>
<p>设计初衷是为了使用<code>JTAG接口(4PIN)</code>在<code>CP阶段</code>对Flash进行测试。</p>
<p>一个STB模块最多可以携带8个Eflash macro, SMIC能够提供测试向量和STB的netlist.</p>
<h2 id="Block-Diagram"><a href="#Block-Diagram" class="headerlink" title="Block Diagram"></a>Block Diagram</h2><h3 id="STB-in-System"><a href="#STB-in-System" class="headerlink" title="STB in System"></a>STB in System</h3><img src="/2024/05/28/smic-auto-eflash-bist/image-20240528134454779.png" class="">



<blockquote>
<p>Note:</p>
<p>1.Dut_Num field selects flash macros,Dut_Num[7:0]  &#x3D; 8’h01 means one Flash Macrois selected, Dut_Num[7:0]  &#x3D; 8’hff means eight Flash Macros are selected;</p>
<p>2.N: The NthFlash.</p>
</blockquote>
<h3 id="STB-Block-Diagram"><a href="#STB-Block-Diagram" class="headerlink" title="STB Block Diagram"></a>STB Block Diagram</h3><img src="/2024/05/28/smic-auto-eflash-bist/image-20240528135925055.png" class="">



<blockquote>
<p>Note:</p>
<p>1.JTAGController: Access all data registers (DR) and instruction registers (IR).</p>
<p>2.Register &amp; Counter: Configure timing and create the proper timing for Function Controller.</p>
<p>3.Function Controller: Exports the proper waveform for flash to execute theerase&#x2F;program&#x2F;read&#x2F;configure.</p>
<p>4.BIST Controller: Algorithmically  generates address&#x2F;data, and create pass&#x2F;fail log. </p>
<p>5.Read NVR_CFG &amp; Config:Auto configure Flash.</p>
<p>6.Erase Retry &amp; Vread:Automatically  completes Erase Retry function  and Vread.</p>
<p> 7.Cycling: Erase, program and read operation are cyclingexecuted.</p>
</blockquote>
<h3 id="Pin-Description"><a href="#Pin-Description" class="headerlink" title="Pin Description"></a>Pin Description</h3><img src="/2024/05/28/smic-auto-eflash-bist/image-20240528140950126.png" class="">



<img src="/2024/05/28/smic-auto-eflash-bist/image-20240528141012829.png" class="">



<img src="/2024/05/28/smic-auto-eflash-bist/image-20240528141033520.png" class="">





<h2 id="Block-Function-Description-of-JTAG-interface"><a href="#Block-Function-Description-of-JTAG-interface" class="headerlink" title="Block Function  Description of JTAG interface"></a>Block Function  Description of JTAG interface</h2><p>TAG interface consists of four parts: test access port (TAP), TAP controller  (state machine), an instruction register and a group of data registers.</p>
<h3 id="Test-access-port-TAP"><a href="#Test-access-port-TAP" class="headerlink" title="Test access port (TAP)"></a>Test access port (TAP)</h3><h3 id="TAP-controller-state-machine"><a href="#TAP-controller-state-machine" class="headerlink" title="TAP controller  (state machine)"></a>TAP controller  (state machine)</h3><h3 id="Signal-interface-Settings"><a href="#Signal-interface-Settings" class="headerlink" title="Signal interface Settings"></a>Signal interface Settings</h3><p><font color=red>TBD</font></p>
<h2 id="Operation-Description"><a href="#Operation-Description" class="headerlink" title="Operation  Description"></a>Operation  Description</h2><h3 id="Instruction-Group"><a href="#Instruction-Group" class="headerlink" title="Instruction Group"></a>Instruction Group</h3><p>There are sevenkindsof instructions: Setup  Instruction, FunctionInstruction, Erase Retry  Instruction, Cycling  Instruction,  Register Instruction,BISTInstruction,  Test  Mode Instruction.</p>
<h3 id="Internal-Register"><a href="#Internal-Register" class="headerlink" title="Internal Register"></a>Internal Register</h3><h4 id="STB-Register"><a href="#STB-Register" class="headerlink" title="STB Register"></a>STB Register</h4><img src="/2024/05/28/smic-auto-eflash-bist/image-20240528142039255.png" class="">



<h4 id="BIST-REG-SOC"><a href="#BIST-REG-SOC" class="headerlink" title="BIST_REG_SOC"></a>BIST_REG_SOC</h4><img src="/2024/05/28/smic-auto-eflash-bist/image-20240528142048774.png" class="">





<h3 id="Setup-Instruction"><a href="#Setup-Instruction" class="headerlink" title="Setup Instruction"></a>Setup Instruction</h3><p>The setup instruction is set the STB output pin high or low. The setup instruction may use together with other instruction for certain operation. </p>
<p>The setup instruction is consist of 8 bits, 7 bits setup ID and 1 bits instruction parameter.</p>
<p><code>All pins controlled by setup instruction  will not change until next setup instruction except “CEb”. If the chip is enable the “CEb” will change accordingly whiletest mode exit.</code></p>
<h4 id="MBIST-Mux-Setup"><a href="#MBIST-Mux-Setup" class="headerlink" title="MBIST Mux Setup"></a>MBIST Mux Setup</h4><p>The MBIST mux setup instruction  will control the <code>BIST_SEL</code>pin. </p>
<h4 id="Flash-Control-Pin-Setup"><a href="#Flash-Control-Pin-Setup" class="headerlink" title="Flash Control Pin Setup"></a>Flash Control Pin Setup</h4><p>The flash control pin setup instruction include :</p>
<p><code>PORb setup, standby setup, deep power down setup, recall setup, CFG lock setup, Vread0 setup, Vread1setup,Sread0 setup and Sread1 setup.</code> These instructions are used to<code> give the flash input a solid state</code>. Only  CEb will change while exiting the test mode. The other pins will remain constant until next setup instruction received.</p>
<h4 id="STB-Counter-Setup"><a href="#STB-Counter-Setup" class="headerlink" title="STB Counter Setup"></a>STB Counter Setup</h4><p>The STB counter setup instruction is used to switch on and off the STB counter. The execution for erase and program time is controlled by STB counter.  <code>By switching off the STB counter,  user can extend the time of erase and program, especially in test mode.</code> Please be noted that switching off the counter could only extend thetime but not shorten the time.</p>
<p><font color=red>啥意思？不懂</font></p>
<h3 id="Function-Instruction"><a href="#Function-Instruction" class="headerlink" title="Function Instruction"></a>Function Instruction</h3><p>The function instruction is used to execute certain operation, like erase, program, read and etc.</p>
<p> It can also use together with setup instruction,  test mode instruction  and BIST instruction. The function instructions consist of instruction  ID and instruction  parameter.</p>
<img src="/2024/05/28/smic-auto-eflash-bist/image-20240528143303435.png" class="">





<h3 id="Erase-Retry-Instruction"><a href="#Erase-Retry-Instruction" class="headerlink" title="Erase Retry Instruction"></a>Erase Retry Instruction</h3><img src="/2024/05/28/smic-auto-eflash-bist/image-20240528143447615.png" class="">



<h3 id="Cycling-Instruction"><a href="#Cycling-Instruction" class="headerlink" title="Cycling Instruction"></a>Cycling Instruction</h3><img src="/2024/05/28/smic-auto-eflash-bist/image-20240528143512853.png" class="">



<h3 id="Register-Instruction"><a href="#Register-Instruction" class="headerlink" title="Register Instruction"></a>Register Instruction</h3><img src="/2024/05/28/smic-auto-eflash-bist/image-20240528143604662.png" class="">



<p><font color=red>啥意思？不懂</font></p>
<h3 id="BIST-Instruction"><a href="#BIST-Instruction" class="headerlink" title="BIST Instruction"></a>BIST Instruction</h3><p>There are four kindsof BISTinstructions:  Chip BIST, Column BIST,SectorBIST and Row BIST. They can reador write all addressof the selected area. The Chip BIST andColumn BIST can only access the NVR&#x2F;MAIN array. There are three patternsfor Chip BIST(Normal, CKBD and Diagonal).</p>
<blockquote>
<ul>
<li>芯片BIST提供了三种模式来执行自测试：正常模式、CKBD模式（Checkerboard，棋盘格模式）和对角线模式。</li>
<li>这三种模式可能会应用不同的测试算法或测试模式，但它们的目标都是对selected area进行操作，并检查读取的结果是否与预期一致</li>
</ul>
</blockquote>
<img src="/2024/05/28/smic-auto-eflash-bist/image-20240528144541432.png" class="">

<img src="/2024/05/28/smic-auto-eflash-bist/image-20240528144548764.png" class="">



<h3 id="Test-Mode-Instruction"><a href="#Test-Mode-Instruction" class="headerlink" title="Test Mode Instruction"></a>Test Mode Instruction</h3><p>Test mode instruction  is for flash going into the relative basic test mode. The test mode instruction can be set one by one and normal operation can be followed. When normal operation finished, the “TM Exit” instruction  should be followed.</p>
<blockquote>
<ul>
<li>这句话表明测试模式指令用于将flash置于一种基本的测试模式中，以执行测试操作。</li>
<li>测试模式指令可以逐个设置，然后可以继续进行正常的操作</li>
</ul>
</blockquote>
<p><font color=red>啥意思？不懂</font></p>
<h1 id="DOC–-BIST-TEST-BENCH-USER-GUIDE"><a href="#DOC–-BIST-TEST-BENCH-USER-GUIDE" class="headerlink" title="DOC–&gt;BIST TEST BENCH USER GUIDE"></a>DOC–&gt;BIST TEST BENCH USER GUIDE</h1><h2 id="List-of-files-required-for-the-simulation"><a href="#List-of-files-required-for-the-simulation" class="headerlink" title="List of files required for the simulation"></a>List of files required for the simulation</h2><img src="/2024/05/28/smic-auto-eflash-bist/image-20240602112715254.png" class="">

<p><font color=blue>rtl sim和port sim使用的testbench文件不一样，需要注意</font></p>
<h2 id="Testbenchnaming-rules"><a href="#Testbenchnaming-rules" class="headerlink" title="Testbenchnaming rules"></a>Testbenchnaming rules</h2><img src="/2024/05/28/smic-auto-eflash-bist/image-20240602112747642.png" class="">



<h2 id="Waived-errors"><a href="#Waived-errors" class="headerlink" title="Waived errors"></a>Waived errors</h2><img src="/2024/05/28/smic-auto-eflash-bist/image-20240602112850662.png" class="">



<h2 id="Waived-warnings"><a href="#Waived-warnings" class="headerlink" title="Waived warnings"></a>Waived warnings</h2><img src="/2024/05/28/smic-auto-eflash-bist/image-20240602112919497.png" class="">



<h2 id="Necessary-modifyfor-interfacefile"><a href="#Necessary-modifyfor-interfacefile" class="headerlink" title="Necessary modifyfor interfacefile"></a>Necessary modifyfor interfacefile</h2><blockquote>
<p>Reason: As the synthesis netlist use ideal clock network, there will be hold violation in <code>netlist simulation</code>. In order to solve this violation, the delay should be added to all flash ADDRports and RDEN ports.If do not modify in interfacefile, verilog model will report “ERRORX-010! Timing Violation@XXns:Tah,target&#x3D;1.00ns;” and BIST read fail.</p>
</blockquote>
<p><font color=blue>netlist级别的仿真需要加上delay</font></p>
<img src="/2024/05/28/smic-auto-eflash-bist/image-20240602113148104.png" class="">



<h1 id="DOC–-eFlash-Macro-Datasheet"><a href="#DOC–-eFlash-Macro-Datasheet" class="headerlink" title="DOC–&gt;eFlash Macro Datasheet"></a>DOC–&gt;eFlash Macro Datasheet</h1><h2 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h2><img src="/2024/05/28/smic-auto-eflash-bist/image-20240528204543207.png" class="">



<h2 id="Product-Description"><a href="#Product-Description" class="headerlink" title="Product Description"></a>Product Description</h2><h3 id="Function-Block-Diagram"><a href="#Function-Block-Diagram" class="headerlink" title="Function Block Diagram"></a>Function Block Diagram</h3><img src="/2024/05/28/smic-auto-eflash-bist/image-20240528211323214.png" class="">

<h3 id="Pin-Description-1"><a href="#Pin-Description-1" class="headerlink" title="Pin Description"></a>Pin Description</h3><img src="/2024/05/28/smic-auto-eflash-bist/image-20240528211417759.png" class="">

<img src="/2024/05/28/smic-auto-eflash-bist/image-20240528211441687.png" class="">

<h3 id="Operation-Modes-Selection"><a href="#Operation-Modes-Selection" class="headerlink" title="Operation Modes Selection"></a>Operation Modes Selection</h3><img src="/2024/05/28/smic-auto-eflash-bist/image-20240529090046913.png" class="">





<h2 id="ECC"><a href="#ECC" class="headerlink" title="ECC"></a>ECC</h2><img src="/2024/05/28/smic-auto-eflash-bist/image-20240604213629620.png" class="">



<h2 id="power-mode"><a href="#power-mode" class="headerlink" title="power mode"></a>power mode</h2><h3 id="Standby-mode"><a href="#Standby-mode" class="headerlink" title="Standby mode"></a>Standby mode</h3><img src="/2024/05/28/smic-auto-eflash-bist/image-20240604213701983.png" class="">



<h3 id="Deep-Power-Down-Mode"><a href="#Deep-Power-Down-Mode" class="headerlink" title="Deep Power Down Mode"></a>Deep Power Down Mode</h3><blockquote>
<p> The device enters the Deep Power Down Mode when both DPD pin and CEb pin are high.<br>Power consumption could be further reduced. However, a tDPD recovery time is needed to<br>return the device back to <code>active mode</code> from deep power down mode.  </p>
</blockquote>
<p><font color=red>TBD:</font>active mode是指进入一些read&#x2F;program的operation mode吗？</p>
<p>从deep power mode到其他operation mode，需要先进入Standby吗？还是直接可以进入？应该需要看时序图确认！！！</p>
<h3 id="Auto-Low-Power-Mode"><a href="#Auto-Low-Power-Mode" class="headerlink" title="Auto Low Power Mode"></a>Auto Low Power Mode</h3><blockquote>
<p>The device has the Auto Lower Power mode which puts it in a near standby mode <code>after data has been accessed with a valid Read operation</code>. This reduces the active Read current to the<br>standby current.<br>While CEb is low, the device exits Auto Low Power mode with CLOCK rising edge when<br>RDEN&#x3D;1 to initiate another Read cycle, <code>with no access time penalty</code>.  </p>
</blockquote>
<p><font color=red>TBD:</font>应该是read 操作之后自动进入low power mode，此时的功耗类似于standby mode。</p>
<h2 id="eflash-operation"><a href="#eflash-operation" class="headerlink" title="eflash operation"></a>eflash operation</h2><h3 id="read"><a href="#read" class="headerlink" title="read"></a>read</h3><blockquote>
<p>The Read operation of the device is triggered by CLOCK rising edge during RDEN&#x3D;1.  Output data width is 150 Bits.  </p>
<p><code>All non-Read operations do not care the status of CLOCK.  </code></p>
<p>CEb must be low for the system to obtain data from the device. When CEb is high, the device<br>is de-selected and only standby power is consumed.（这里说的应该就是Auto Low Power Mode）<br><code>The data output is reset to be all zero by Power on Reset, or CEb high  </code></p>
</blockquote>
<p><font color=red>所以我理解在实现的时候，read操作之后不需要进入主动进入standby mode；这样连续读写可以节省进入和退出standby mode的时间；</font></p>
<h3 id="Recall-Read"><a href="#Recall-Read" class="headerlink" title="Recall Read"></a>Recall Read</h3><p>Recall Read is a special slow read mode to obtain the configuration bits from the NVR and<br>NVR_CFG sectors before VREF can be accurately configured.  </p>
<p><font color=red>TBD:应该只有NVF_CFG也就是NVR_1需要用recall read吧？</font></p>
<h4 id="Read-Cycle-Timing-Parameters-Cload-0-15pF"><a href="#Read-Cycle-Timing-Parameters-Cload-0-15pF" class="headerlink" title="Read Cycle Timing Parameters (Cload&#x3D;0.15pF)"></a>Read Cycle Timing Parameters (Cload&#x3D;0.15pF)</h4><img src="/2024/05/28/smic-auto-eflash-bist/image-20240605092527921.png" class="">



<h4 id="Read-Cycle-Timing-Diagram"><a href="#Read-Cycle-Timing-Diagram" class="headerlink" title="Read Cycle Timing Diagram"></a>Read Cycle Timing Diagram</h4><img src="/2024/05/28/smic-auto-eflash-bist/image-20240529104433588.png" class="">



<h3 id="Program"><a href="#Program" class="headerlink" title="Program"></a>Program</h3><blockquote>
<p>The device is programmed on 75 bits basis. DINSEL selects one of 75 bits out of 150 bits<br>word.  </p>
</blockquote>
<p>program的最小单位是75bits；</p>
<h4 id="Program-Erase-Cycle-Timing-Parameters"><a href="#Program-Erase-Cycle-Timing-Parameters" class="headerlink" title="Program&#x2F;Erase Cycle Timing Parameters"></a>Program&#x2F;Erase Cycle Timing Parameters</h4><img src="/2024/05/28/smic-auto-eflash-bist/image-20240605094745072.png" class="">

<h4 id="Program-Cycle-Timing-Diagram"><a href="#Program-Cycle-Timing-Diagram" class="headerlink" title="Program Cycle Timing Diagram"></a>Program Cycle Timing Diagram</h4><img src="/2024/05/28/smic-auto-eflash-bist/image-20240529104819187.png" class="">

<img src="/2024/05/28/smic-auto-eflash-bist/image-20240529104843799.png" class="">





<h3 id="Sector-Erase"><a href="#Sector-Erase" class="headerlink" title="Sector Erase"></a>Sector Erase</h3><blockquote>
<p>The sector erase operation erases the device on a sector-by-sector basis.  </p>
</blockquote>
<h3 id="Block-Erase"><a href="#Block-Erase" class="headerlink" title="Block Erase"></a>Block Erase</h3><blockquote>
<p> Block erase operation could erase total 16 sectors organized as block for main array.   </p>
<p>During a block erase, users could also specify a combination of multiple redundancy sectors<br>to be erased with main array sectors.   </p>
</blockquote>
<p>7843项目中flash controller没有实现这个操作；</p>
<img src="/2024/05/28/smic-auto-eflash-bist/image-20240528210008315.png" class="">

<h3 id="Chip-Erase"><a href="#Chip-Erase" class="headerlink" title="Chip Erase"></a>Chip Erase</h3><img src="/2024/05/28/smic-auto-eflash-bist/image-20240528205914524.png" class="">

<img src="/2024/05/28/smic-auto-eflash-bist/image-20240528210021298.png" class="">



<h3 id="Charge-Pump-Sharing"><a href="#Charge-Pump-Sharing" class="headerlink" title="Charge Pump Sharing"></a>Charge Pump Sharing</h3><blockquote>
<p>Its charge pump block (macro name: bias_340sa128kx150_v1) can be shared among up to 2<br>Flash macros. Before the signals connecting to the pump, the logic signals from different<br>devices should be <code>multiplexed</code>, whereas the analog signals from different devices must be<br>wire-connected.<br>The read while write and the read while read operations can be done in two different<br>instances with a shared charge pump simultaneously, but <code>the concurrent writes cannot be allowed</code>.<br><code>Bias IP must be in power off mode when any shared flash IP enter power off mode.  </code></p>
</blockquote>
<p><font color=blue>design上是对多个Macro信号或操作连接到bias；只使用一种bias IP，能够对不同size的Flash macro进行操作</font></p>
<h3 id="Power-On-Reset-PORb"><a href="#Power-On-Reset-PORb" class="headerlink" title="Power On Reset (PORb)"></a>Power On Reset (PORb)</h3><blockquote>
<p>The Power On Reset pin (PORb) is used to reset the device during power-on. When the<br>PORb pin is held low, any in-progress operation will be terminated, and all internal registers<br>are cleared.  </p>
</blockquote>
<h3 id="NVR-Sectors"><a href="#NVR-Sectors" class="headerlink" title="NVR Sectors"></a>NVR Sectors</h3><blockquote>
<p>NVR array is a group of special sectors outside the main array memory space. NVR array has<br>32 sectors which can be selected by the NVR pin.  </p>
</blockquote>
<h3 id="NVR-CFG-Sector"><a href="#NVR-CFG-Sector" class="headerlink" title="NVR_CFG Sector"></a>NVR_CFG Sector</h3><blockquote>
<p>The device’s configuration information is written into a special NVR_CFG sector during wafer<br>testing. User can access its contents with NVR_CFG&#x3D;1 and RECALL&#x3D;1.<br>To prevent configuration information being inadvertently damaged, a pin LCK_CFG&#x3D;1 is used<br>to protect this NVR_CFG sector.<br>NVR_CFG sector can be programmed or erased for testing purpose only.  </p>
<p>In NVR_CFG sector, every even and odd row pair (row 0&#x2F;1, row 2&#x2F;3 …) should be<br>programmed with same data pattern. In read mode, the data of even&#x2F;odd pair is read out  simultaneously as one word, so its sector size is only a half of 128 x 150 bits.   </p>
</blockquote>
<h3 id="Pre-Program"><a href="#Pre-Program" class="headerlink" title="Pre-Program"></a>Pre-Program</h3><blockquote>
<p>Before a program operation, same data should be programmed onto the target address with a<br>shorter program pulse. A program operation with PREPG high indicates a Pre-Program<br>operation.<br>Pre-Program multiple words in the same row before the program operations can reduce the<br>Pre-program time overhead.  </p>
</blockquote>
<h3 id="Erase-Retry"><a href="#Erase-Retry" class="headerlink" title="Erase Retry"></a>Erase Retry</h3><blockquote>
<p>Erase Retry uses a step-up voltage scheme with a maximum of 20 retry pulses. The<br>RETRY[1:0] pins specify the retry voltage level for each retry pulse. RETRY[1:0] should be<br>’11 for single pulse sector&#x2F;block erase and chip erase.<br>The Verify Read (VREAD1&#x3D;1) is used to check whether a sector&#x2F;block has been successfully<br>erased after each pulse. An extra retry operation is needed if the sector&#x2F;block is not erased<br>successfully.<br>No verify Read is needed for the last pulse as the cumulative erase time is already sufficient.<br>Erase retry scheme should be used for sector&#x2F;block erase only, not chip erase.  </p>
</blockquote>
<h3 id="Verify-Read"><a href="#Verify-Read" class="headerlink" title="Verify Read"></a>Verify Read</h3><blockquote>
<p>Verify read is a special read mode to guarantee a successful write operation. Verify read is<br>controlled by the pin VREAD1 and VREAD0. The access time is slower than normal read.  </p>
</blockquote>
<h3 id="Safety-Read"><a href="#Safety-Read" class="headerlink" title="Safety Read"></a>Safety Read</h3><blockquote>
<p>Safety read 0&#x2F;1 is a special read mode to detect whether any flash bit has experienced<br>unusual reduction in read margin. Safety read 0 is controlled by the pin SREAD0, and safety<br>read 1 is controlled by the pin SREAD1. Their access time is the same as a normal read.  </p>
</blockquote>
<h3 id="Row-Redundancy"><a href="#Row-Redundancy" class="headerlink" title="Row Redundancy"></a>Row Redundancy</h3><blockquote>
<p>There are 4 redundancy sectors: These 4 redundancy sectors can be used to replace the bad<br>sectors of main array. See Table: NVR, Redundancy Sector Selection.<br>The redundancy information is stored at several locations of NVR_CFG sector.   </p>
</blockquote>
<h3 id="Set-Configuration-Register"><a href="#Set-Configuration-Register" class="headerlink" title="Set Configuration Register"></a>Set Configuration Register</h3><blockquote>
<p>For obtain required performance, it is necessary to set configuration bits into the registers of<br>the device.<br>Before normal read&#x2F;program&#x2F;erase operation, eight groups of configuration data must be read<br>from the device while RECALL and NVR_CFG are high and written to eight groups of<br>configuration registers (16 bits for each group) in the device. These configuration registers are<br>selected by A[2:0] when CONFEN is high. Only 16 LSB bits of each word are effective  configuration bits. </p>
<p>Word 0 maps to address 000, Word1 maps to address 001, etc.   </p>
<p>After power on reset, all configuration registers are reset and need to be rewritten before any<br>other operations  </p>
<p>To set RECALL pin high during Set Configuration Registers operation, performing Recall<br>Read and Set Configuration Registers sequentially can help reduce time overhead.  </p>
</blockquote>
<h3 id="Configuration-Register-Read"><a href="#Configuration-Register-Read" class="headerlink" title="Configuration Register Read"></a>Configuration Register Read</h3><blockquote>
<p>After all configuration registers are written, the contents of the configuration registers can be<br>read out to device pins by configuration register read.<br>Those configuration registers are selected by A[2:0] when CONFEN&#x3D;1 and RDEN&#x3D;1 at the<br>rising edge of CLOCK. Only 16 LSB bits of each word are read out to DOUT[15:0].  </p>
</blockquote>
<h3 id="Power-Off"><a href="#Power-Off" class="headerlink" title="Power Off"></a>Power Off</h3><blockquote>
<p>The device can be completely turned off by an internal power switch when SUPPLYON&#x3D;0.<br>This power switch should be turned on (SUPPLYON&#x3D;1) after power up and constantly<br>remained for any operations. Flash IPs and their shared Bias IP must go to power off mode<br>together.<br>Power on reset should be activated during supply switching off, therefore all configuration<br>registers will lose the current value and they must be reloaded again before the next<br>read&#x2F;write operation.<br>When the device is switched off, all output pins from pfm are floated.  </p>
</blockquote>
<h2 id="其他说明"><a href="#其他说明" class="headerlink" title="其他说明"></a>其他说明</h2><h3 id="NVR-Redundancy-Sector-Selection"><a href="#NVR-Redundancy-Sector-Selection" class="headerlink" title="NVR,Redundancy Sector Selection"></a>NVR,Redundancy Sector Selection</h3><img src="/2024/05/28/smic-auto-eflash-bist/image-20240529090244081.png" class="">

<h3 id="Memory-Array-Configuraton"><a href="#Memory-Array-Configuraton" class="headerlink" title="Memory Array Configuraton"></a>Memory Array Configuraton</h3><img src="/2024/05/28/smic-auto-eflash-bist/image-20240529090349066.png" class="">

<h3 id="Configuration-Data-and-Redundancy-Storage-in-NVR-CFG"><a href="#Configuration-Data-and-Redundancy-Storage-in-NVR-CFG" class="headerlink" title="Configuration Data and Redundancy Storage in NVR_CFG"></a>Configuration Data and Redundancy Storage in NVR_CFG</h3><img src="/2024/05/28/smic-auto-eflash-bist/image-20240606142930577.png" class="">

<h3 id="Configuration-Data-Mapping-Table"><a href="#Configuration-Data-Mapping-Table" class="headerlink" title="Configuration Data Mapping Table"></a>Configuration Data Mapping Table</h3><img src="/2024/05/28/smic-auto-eflash-bist/image-20240606144800615.png" class="">

<h3 id="Connection-between-multiple-Flash-IP-and-Pump-IP"><a href="#Connection-between-multiple-Flash-IP-and-Pump-IP" class="headerlink" title="Connection between multiple Flash IP and Pump IP"></a>Connection between multiple Flash IP and Pump IP</h3><img src="/2024/05/28/smic-auto-eflash-bist/image-20240602144959234.png" class="">





<p><font color=blue>testbench学习理解</font></p>
<h1 id="Testbench–-STB-operation-simulaiton"><a href="#Testbench–-STB-operation-simulaiton" class="headerlink" title="Testbench–&gt;STB operation simulaiton"></a>Testbench–&gt;STB operation simulaiton</h1><h2 id="chip-erase"><a href="#chip-erase" class="headerlink" title="chip erase"></a>chip erase</h2><blockquote>
<p>含义：erase entire main arrary, redundancy sectors and NVR sectors all together or seprately</p>
</blockquote>
<p><font color=red>TBD</font></p>
<p>观察STB输出的控制信号即可，不用太过关注testbench 指令</p>
<h2 id="sector-erase"><a href="#sector-erase" class="headerlink" title="sector erase"></a>sector erase</h2><h1 id="Q-A"><a href="#Q-A" class="headerlink" title="Q&amp;A"></a>Q&amp;A</h1><h2 id="STB-in-System-章节中，SoC-REG的作用？"><a href="#STB-in-System-章节中，SoC-REG的作用？" class="headerlink" title="STB in System 章节中，SoC REG的作用？"></a>STB in System 章节中，SoC REG的作用？</h2><p>首先这是一个输出端口，是SoC控制寄存器，用于在flash test mode下，输出信息，让外部调节电压</p>
<p>7843项目中，将此信号连接到Standby 模块；</p>
<p><font color=red>TBD</font></p>
<h2 id="仿真地址问题"><a href="#仿真地址问题" class="headerlink" title="仿真地址问题"></a>仿真地址问题</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wzjsdyx.github.io/2024/05/27/makefile%E8%84%9A%E6%9C%AC%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/animal_toy_cute_doll_teddy_256.png">
      <meta itemprop="name" content="Youngster">
      <meta itemprop="description" content="show me bug">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="芯青年">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/05/27/makefile%E8%84%9A%E6%9C%AC%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" class="post-title-link" itemprop="url">makefile脚本基础知识</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-05-27 10:31:01 / 修改时间：10:47:27" itemprop="dateCreated datePublished" datetime="2024-05-27T10:31:01+08:00">2024-05-27</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%84%9A%E6%9C%AC/" itemprop="url" rel="index"><span itemprop="name">脚本</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%84%9A%E6%9C%AC/makefile%E8%84%9A%E6%9C%AC/" itemprop="url" rel="index"><span itemprop="name">makefile脚本</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/05/27/makefile%E8%84%9A%E6%9C%AC%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/05/27/makefile%E8%84%9A%E6%9C%AC%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="目标和伪目标"><a href="#目标和伪目标" class="headerlink" title="目标和伪目标"></a>目标和伪目标</h1><h1 id="makefile执行顺序"><a href="#makefile执行顺序" class="headerlink" title="makefile执行顺序"></a>makefile执行顺序</h1><p>在Makefile中，当执行某个伪目标（.PHONY target）时，伪目标中的每条指令都会按顺序执行。每条指令都需要等待上一条指令执行完毕才能执行下一条指令，包括执行长时间运行的命令。</p>
<p>例如，考虑以下Makefile示例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">makefile复制代码.PHONY: my_target</span><br><span class="line"></span><br><span class="line">my_target:</span><br><span class="line">    @<span class="built_in">echo</span> <span class="string">&quot;Starting process A...&quot;</span></span><br><span class="line">    @<span class="built_in">sleep</span> 5</span><br><span class="line">    @<span class="built_in">echo</span> <span class="string">&quot;Process A completed.&quot;</span></span><br><span class="line">    @<span class="built_in">echo</span> <span class="string">&quot;Starting process B...&quot;</span></span><br><span class="line">    @<span class="built_in">sleep</span> 10</span><br><span class="line">    @<span class="built_in">echo</span> <span class="string">&quot;Process B completed.&quot;</span></span><br></pre></td></tr></table></figure>

<p>在这个示例中，当执行<code>make my_target</code>时，会依次执行两个进程A和B。进程B会在进程A完成后才开始执行，因为Makefile会按顺序执行每个命令行中的命令。</p>
<p>因此，如果某个命令需要执行很长时间，后续的命令会等待它执行完成后再继续执行。</p>
<h1 id="makefile传递参数"><a href="#makefile传递参数" class="headerlink" title="makefile传递参数"></a>makefile传递参数</h1><p>要在Makefile中传递参数，你可以使用命令行参数（Makefile变量）和make命令后面的参数。下面是一个示例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">makefile复制代码.PHONY: run</span><br><span class="line"></span><br><span class="line">run:</span><br><span class="line">    @<span class="built_in">mkdir</span> $(DIR)</span><br></pre></td></tr></table></figure>

<p>在这个示例中，<code>DIR</code>是一个Makefile变量，它将在make命令后面通过参数传递。你可以像这样运行make命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arduino</span><br><span class="line">复制代码</span><br><span class="line">make run DIR=my_directory</span><br></pre></td></tr></table></figure>

<p>这样，Makefile中的<code>run</code>目标会创建一个名为<code>my_directory</code>的目录。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wzjsdyx.github.io/2024/05/24/Cortex-M4-demo-SoC%E6%90%AD%E5%BB%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/animal_toy_cute_doll_teddy_256.png">
      <meta itemprop="name" content="Youngster">
      <meta itemprop="description" content="show me bug">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="芯青年">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/05/24/Cortex-M4-demo-SoC%E6%90%AD%E5%BB%BA/" class="post-title-link" itemprop="url">Cortex-M4 demo SoC搭建</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-05-24 09:23:38" itemprop="dateCreated datePublished" datetime="2024-05-24T09:23:38+08:00">2024-05-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-06 17:45:35" itemprop="dateModified" datetime="2024-06-06T17:45:35+08:00">2024-06-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/SoC%E8%AE%BE%E8%AE%A1/" itemprop="url" rel="index"><span itemprop="name">SoC设计</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/05/24/Cortex-M4-demo-SoC%E6%90%AD%E5%BB%BA/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/05/24/Cortex-M4-demo-SoC%E6%90%AD%E5%BB%BA/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>使用ARM交付包 搭建一个demo的SoC</p>
<blockquote>
<p>AT521 –&gt; Cortex-M4</p>
<p>TM925 –&gt; ETM</p>
<p>创建的仿真环境在 merge_work_dir1</p>
</blockquote>
<h1 id="demo-SoC-testbench"><a href="#demo-SoC-testbench" class="headerlink" title="demo SoC testbench"></a>demo SoC testbench</h1><img src="/2024/05/24/Cortex-M4-demo-SoC%E6%90%AD%E5%BB%BA/image-20240606173034184.png" class="">


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Youngster"
      src="/images/animal_toy_cute_doll_teddy_256.png">
  <p class="site-author-name" itemprop="name">Youngster</p>
  <div class="site-description" itemprop="description">show me bug</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">93</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">115</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Youngster</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : '3qPpN2UkBU7Q1vhWnH1WdrQZ-gzGzoHsz',
      appKey     : 'LAapaVzfFkIj1knpaWSWCNDo',
      placeholder: "Looking forward to communication.",
      avatar     : 'monsterid',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
